<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>heap.js - Documentation</title>

    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="Collection.html">Collection</a><ul class='methods'><li data-type='method'><a href="Collection.html#.From">From (static)</a></li><li data-type='method'><a href="Collection.html#.Range">Range (static)</a></li><li data-type='method'><a href="Collection.html#.Repeat">Repeat (static)</a></li><li data-type='method'><a href="Collection.html#Add">Add</a></li><li data-type='method'><a href="Collection.html#Aggregateaccumulator">Aggregate(accumulator)</a></li><li data-type='method'><a href="Collection.html#Aggregateseed,accumulator">Aggregate(seed, accumulator)</a></li><li data-type='method'><a href="Collection.html#Aggregateseed,accumulator,resultTransformFn">Aggregate(seed, accumulator, resultTransformFn)</a></li><li data-type='method'><a href="Collection.html#All">All</a></li><li data-type='method'><a href="Collection.html#Any">Any</a></li><li data-type='method'><a href="Collection.html#Anypredicate">Any(predicate)</a></li><li data-type='method'><a href="Collection.html#Average">Average()</a></li><li data-type='method'><a href="Collection.html#AveragemapFn">Average(mapFn)</a></li><li data-type='method'><a href="Collection.html#Concat">Concat</a></li><li data-type='method'><a href="Collection.html#ConditionalWherecondition,(elem,index)=%253Ebool">ConditionalWhere(condition, (elem, index) => bool)</a></li><li data-type='method'><a href="Collection.html#ConditionalWherecondition,elem=%253Ebool">ConditionalWhere(condition, elem => bool)</a></li><li data-type='method'><a href="Collection.html#Containselem">Contains(elem)</a></li><li data-type='method'><a href="Collection.html#Containselem,equalityCompareFn">Contains(elem, equalityCompareFn)</a></li><li data-type='method'><a href="Collection.html#Count">Count()</a></li><li data-type='method'><a href="Collection.html#Countpredicate">Count(predicate)</a></li><li data-type='method'><a href="Collection.html#DefaultIfEmptyconstructor">DefaultIfEmpty(constructor)</a></li><li data-type='method'><a href="Collection.html#DefaultIfEmptydefaultValue">DefaultIfEmpty(defaultValue)</a></li><li data-type='method'><a href="Collection.html#Distinct">Distinct()</a></li><li data-type='method'><a href="Collection.html#DistinctequalityCompareFn">Distinct(equalityCompareFn)</a></li><li data-type='method'><a href="Collection.html#ElementAt">ElementAt</a></li><li data-type='method'><a href="Collection.html#Except">Except</a></li><li data-type='method'><a href="Collection.html#First">First()</a></li><li data-type='method'><a href="Collection.html#Firstpredicate">First(predicate)</a></li><li data-type='method'><a href="Collection.html#FirstOrDefault">FirstOrDefault()</a></li><li data-type='method'><a href="Collection.html#FirstOrDefaultpredicate">FirstOrDefault(predicate)</a></li><li data-type='method'><a href="Collection.html#Flatten">Flatten</a></li><li data-type='method'><a href="Collection.html#ForEach">ForEach</a></li><li data-type='method'><a href="Collection.html#GroupBykeySelector">GroupBy(keySelector)</a></li><li data-type='method'><a href="Collection.html#GroupBykeySelector,elementSelector">GroupBy(keySelector, elementSelector)</a></li><li data-type='method'><a href="Collection.html#GroupBykeySelector,elementSelector,keyComparer">GroupBy(keySelector, elementSelector, keyComparer)</a></li><li data-type='method'><a href="Collection.html#GroupBykeySelector,elementSelector,resultSelector">GroupBy(keySelector, elementSelector, resultSelector)</a></li><li data-type='method'><a href="Collection.html#GroupBykeySelector,elementSelector,resultSelector,keyComparer">GroupBy(keySelector, elementSelector, resultSelector, keyComparer)</a></li><li data-type='method'><a href="Collection.html#GroupBykeySelector,keyComparer">GroupBy(keySelector, keyComparer)</a></li><li data-type='method'><a href="Collection.html#GroupBykeySelector,resultSelector">GroupBy(keySelector, resultSelector)</a></li><li data-type='method'><a href="Collection.html#GroupBykeySelector,resultSelector,keyComparer">GroupBy(keySelector, resultSelector, keyComparer)</a></li><li data-type='method'><a href="Collection.html#GroupJoininner,outerKeySelector,innerKeySelector,resultSelector">GroupJoin(inner, outerKeySelector, innerKeySelector, resultSelector)</a></li><li data-type='method'><a href="Collection.html#GroupJoininner,outerKeySelector,innerKeySelector,resultSelector,keyComparer">GroupJoin(inner, outerKeySelector, innerKeySelector, resultSelector, keyComparer)</a></li><li data-type='method'><a href="Collection.html#IndexOf">IndexOf()</a></li><li data-type='method'><a href="Collection.html#IndexOfequalityCompareFn">IndexOf(equalityCompareFn)</a></li><li data-type='method'><a href="Collection.html#Insert">Insert</a></li><li data-type='method'><a href="Collection.html#Intersectinner">Intersect(inner)</a></li><li data-type='method'><a href="Collection.html#Intersectinner,equalityCompareFn">Intersect(inner, equalityCompareFn)</a></li><li data-type='method'><a href="Collection.html#Join">Join</a></li><li data-type='method'><a href="Collection.html#Last">Last()</a></li><li data-type='method'><a href="Collection.html#Lastpredicate">Last(predicate)</a></li><li data-type='method'><a href="Collection.html#LastIndexOf">LastIndexOf()</a></li><li data-type='method'><a href="Collection.html#LastIndexOfequalityCompareFn">LastIndexOf(equalityCompareFn)</a></li><li data-type='method'><a href="Collection.html#LastOrDefault">LastOrDefault()</a></li><li data-type='method'><a href="Collection.html#LastOrDefaultpredicate">LastOrDefault(predicate)</a></li><li data-type='method'><a href="Collection.html#Max">Max()</a></li><li data-type='method'><a href="Collection.html#MaxmapFn">Max(mapFn)</a></li><li data-type='method'><a href="Collection.html#Min">Min()</a></li><li data-type='method'><a href="Collection.html#MinmapFn">Min(mapFn)</a></li><li data-type='method'><a href="Collection.html#Order">Order()</a></li><li data-type='method'><a href="Collection.html#Ordercomparator">Order(comparator)</a></li><li data-type='method'><a href="Collection.html#OrderBykeySelector">OrderBy(keySelector)</a></li><li data-type='method'><a href="Collection.html#OrderBykeySelector,comparator">OrderBy(keySelector, comparator)</a></li><li data-type='method'><a href="Collection.html#OrderByDescendingkeySelector">OrderByDescending(keySelector)</a></li><li data-type='method'><a href="Collection.html#OrderByDescendingkeySelector,comparator">OrderByDescending(keySelector, comparator)</a></li><li data-type='method'><a href="Collection.html#OrderDescending">OrderDescending()</a></li><li data-type='method'><a href="Collection.html#OrderDescendingcomparator">OrderDescending(comparator)</a></li><li data-type='method'><a href="Collection.html#Remove">Remove</a></li><li data-type='method'><a href="Collection.html#Reverse">Reverse</a></li><li data-type='method'><a href="Collection.html#Select(elem,index)=%253Eany">Select((elem, index) => any)</a></li><li data-type='method'><a href="Collection.html#Selectelem=%253Eany">Select(elem => any)</a></li><li data-type='method'><a href="Collection.html#SelectMany(elem,index)=%253Eany">SelectMany((elem, index) => any)</a></li><li data-type='method'><a href="Collection.html#SelectMany(elem,index)=%253Eany,resultSelector">SelectMany((elem, index) => any, resultSelector)</a></li><li data-type='method'><a href="Collection.html#SelectManyelem=%253Eany">SelectMany(elem => any)</a></li><li data-type='method'><a href="Collection.html#SelectManyelem=%253Eany,resultSelector">SelectMany(elem => any, resultSelector)</a></li><li data-type='method'><a href="Collection.html#SequenceEqualsecond">SequenceEqual(second)</a></li><li data-type='method'><a href="Collection.html#SequenceEqualsecond,equalityCompareFn">SequenceEqual(second, equalityCompareFn)</a></li><li data-type='method'><a href="Collection.html#Shuffle">Shuffle</a></li><li data-type='method'><a href="Collection.html#Single">Single()</a></li><li data-type='method'><a href="Collection.html#Singlepredicate">Single(predicate)</a></li><li data-type='method'><a href="Collection.html#SingleOrDefault">SingleOrDefault()</a></li><li data-type='method'><a href="Collection.html#SingleOrDefaultpredicate">SingleOrDefault(predicate)</a></li><li data-type='method'><a href="Collection.html#Skip">Skip</a></li><li data-type='method'><a href="Collection.html#SkipUntil(elem,index)=%253Eboolean">SkipUntil((elem, index) => boolean)</a></li><li data-type='method'><a href="Collection.html#SkipUntilelem=%253Eboolean">SkipUntil(elem => boolean)</a></li><li data-type='method'><a href="Collection.html#SkipWhile(elem,index)=%253Eboolean">SkipWhile((elem, index) => boolean)</a></li><li data-type='method'><a href="Collection.html#SkipWhileelem=%253Eboolean">SkipWhile(elem => boolean)</a></li><li data-type='method'><a href="Collection.html#Sum">Sum()</a></li><li data-type='method'><a href="Collection.html#SummapFn">Sum(mapFn)</a></li><li data-type='method'><a href="Collection.html#Take">Take</a></li><li data-type='method'><a href="Collection.html#TakeUntil(elem,index)=%253Eboolean">TakeUntil((elem, index) => boolean)</a></li><li data-type='method'><a href="Collection.html#TakeUntilelem=%253Eboolean">TakeUntil(elem => boolean)</a></li><li data-type='method'><a href="Collection.html#TakeWhile(elem,index)=%253Eboolean">TakeWhile((elem, index) => boolean)</a></li><li data-type='method'><a href="Collection.html#TakeWhileelem=%253Eboolean">TakeWhile(elem => boolean)</a></li><li data-type='method'><a href="Collection.html#ToArray">ToArray</a></li><li data-type='method'><a href="Collection.html#ToDictionarykeySelector">ToDictionary(keySelector)</a></li><li data-type='method'><a href="Collection.html#ToDictionarykeySelector,elementSelector">ToDictionary(keySelector, elementSelector)</a></li><li data-type='method'><a href="Collection.html#ToDictionarykeySelector,elementSelector,keyComparer">ToDictionary(keySelector, elementSelector, keyComparer)</a></li><li data-type='method'><a href="Collection.html#ToDictionarykeySelector,keyComparer">ToDictionary(keySelector, keyComparer)</a></li><li data-type='method'><a href="Collection.html#ToJSON">ToJSON</a></li><li data-type='method'><a href="Collection.html#UnionequalityCompareFn">Union(equalityCompareFn)</a></li><li data-type='method'><a href="Collection.html#Unioninner">Union(inner)</a></li><li data-type='method'><a href="Collection.html#Where(elem,index)=%253Eboolean">Where((elem, index) => boolean)</a></li><li data-type='method'><a href="Collection.html#Whereelem=%253Eboolean">Where(elem => boolean)</a></li><li data-type='method'><a href="Collection.html#Zip">Zip</a></li></ul></li><li><a href="OrderedCollection.html">OrderedCollection</a><ul class='methods'><li data-type='method'><a href="OrderedCollection.html#ThenBykeySelector">ThenBy(keySelector)</a></li><li data-type='method'><a href="OrderedCollection.html#ThenBykeySelector,comparator">ThenBy(keySelector, comparator)</a></li><li data-type='method'><a href="OrderedCollection.html#ThenByDescendingkeySelector">ThenByDescending(keySelector)</a></li><li data-type='method'><a href="OrderedCollection.html#ThenByDescendingkeySelector,comparator">ThenByDescending(keySelector, comparator)</a></li></ul></li></ul><h3>Global</h3><ul><li><a href="global.html#defaultComparator">defaultComparator</a></li><li><a href="global.html#GetComparatorFromKeySelector">GetComparatorFromKeySelector</a></li><li><a href="global.html#getEqualKey">getEqualKey</a></li><li><a href="global.html#HeapElement">HeapElement</a></li><li><a href="global.html#paramOrValue">paramOrValue</a></li></ul>
</nav>

<div id="main">
    
    <h1 class="page-title">heap.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * HeapElement class that also provides the element index for sorting.
 */
let HeapElement = (function () {

    /**
     * Creates a new HeapElement.
     *
     * @param {number} index Element index.
     * @param {T}      value Element value.
     * @param {any}    &lt;T>   Value type.
     */
    function HeapElement (index, value) {
        this.__index = index;
        this.__value = value;

        // for faster instance detection
        this.__isHeapElementInstance = true;
    }

    /**
     * Creates or returns a heap element from the given data.
     * If obj is a HeapElement obj is returned, creates a HeapElement otherwise.
     *
     * @param {number}           index Current element index.
     * @param {T|HeapElement&lt;T>} obj   Element.
     * @param {any}              &lt;T>   Value type.
     * @return {HeapElement&lt;T>} Created heap element or obj if it already is a heap object.
     */
    HeapElement.CreateHeapElement = function (index, obj) {
        if (obj === undefined || obj.__isHeapElementInstance) {
            return obj;
        }
        return new HeapElement(index, obj);
    };

    return HeapElement;
})();

/*
 * Partially sorted heap that contains the smallest element within root position.
 */
let MinHeap = (function () {

    /**
     * Creates the heap from the array of elements with the given comparator function.
     *
     * @param {T[]}              elements   Array with elements to create the heap from.
     *                                      Will be modified in place for heap logic.
     * @param {(T, T) => number} comparator Comparator function (same as the one for Array.sort()).
     * @param {any}              &lt;T>        Heap element type.
     */
    function MinHeap (elements, comparator = defaultComparator) {
        __assertArray(elements);
        __assertFunction(comparator);

        // we do not wrap elements here since the heapify function does that the moment it encounters elements
        this.elements = elements;

        // create comparator that works on heap elements (it also ensures equal elements remain in original order)
        this.comparator = (a, b) => {
            let res = comparator(a.__value, b.__value);

            if (res !== 0) {
                return res;
            }

            return defaultComparator(a.__index, b.__index);
        };

        // create heap ordering
        createHeap(this.elements, this.comparator);
    }

    /**
     * Places the element at the given position into the correct position within the heap.
     *
     * @param {T}                elements   Array with elements used for the heap.
     * @param {(T, T) => number} comparator Comparator function (same as the one for Array.sort()).
     * @param {number}           i          Index of the element that will be placed to the correct position.
     * @param {any}              &lt;T>        Heap element type.
     */
    function heapify (elements, comparator, i) {
        let right     = 2 * (i + 1);
        let left      = right - 1;
        let bestIndex = i;

        // wrap elements the moment we encouter them first
        elements[bestIndex] = HeapElement.CreateHeapElement(bestIndex, elements[bestIndex]);

        // check if the element is currently misplaced
        if (left &lt; elements.length) {
            elements[left] = HeapElement.CreateHeapElement(left, elements[left]);
            if (comparator(elements[left], elements[bestIndex]) &lt; 0) {
                bestIndex = left;
            }
        }
        if (right &lt; elements.length) {
            elements[right] = HeapElement.CreateHeapElement(right, elements[right]);
            if (comparator(elements[right], elements[bestIndex]) &lt; 0) {
                bestIndex = right;
            }
        }

        // if the element is misplaced, swap elements and continue until we get the right position
        if (bestIndex !== i) {
            let tmp = elements[i];
            elements[i] = elements[bestIndex];
            elements[bestIndex] = tmp;

            // let misplaced elements "bubble up" to get heap properties
            heapify(elements, comparator, bestIndex);
        }
    }

    /**
     * Creates a heap from the given array using the given comparator.
     *
     * @param {T[]}              elements   Array with elements used for the heap.
     *                                      Will be modified in place for heap logic.
     * @param {(T, T) => number} comparator Comparator function (same as the one for Array.sort()).
     * @param {any}              &lt;T>        Heap element type.
     */
    function createHeap (elements, comparator) {

        // sepecial case: empty array
        if (elements.length === 0) {

            // nothing to do here
            return;
        }

        for (let i = Math.floor(elements.length / 2); i >= 0; i--) {

            // do fancy stuff
            heapify(elements, comparator, i);
        }
    }

    /**
     * Checks if the heap contains at least one element.
     *
     * @return {boolean} If the heap contains elements or not.
     */
    MinHeap.prototype.hasTopElement = function () {
        return this.elements.length > 0;
    };

    /**
     * Gets and removes the top element from the heap.
     * This method performs a bit of reordering to keep heap properties.
     *
     * @param {any} &lt;T> Heap element type.
     *
     * @return {T} Top element from heap.
     */
    MinHeap.prototype.getTopElement = function () {

        // special case: only one element left
        if (this.elements.length === 1) {
            return this.elements.pop().__value;
        }

        let topElement = this.elements[0];
        let tmp = this.elements.pop();
        this.elements[0] = tmp;

        // do fancy stuff
        heapify(this.elements, this.comparator, 0);

        return topElement.__value;
    };

    /**
     * Creates an iterator for this heap instance.
     *
     * @return {Iterator} Iterator for the heap.
     */
    MinHeap.prototype[Symbol.iterator] = function () {

        // keep matching heap instance
        let heap = this;
        return {
            next: function () {
                if (heap.hasTopElement()) {
                    return {
                        done:  false,
                        value: heap.getTopElement()
                    };
                }
                return {
                    done: true
                };
            }
        }
    };

    return MinHeap;
})();

__export({ MinHeap })
</code></pre>
        </article>
    </section>




</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.4.2</a> on Fri Oct 14 2016 14:06:56 GMT+0200 (CEST) using the Minami theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>
</body>
</html>
