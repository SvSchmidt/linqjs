define(["require","exports"],function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});class n extends Error{constructor(t,e){super(`Expected ${t}, got ${e}!`)}}function r(t,...e){if(!t)throw 2===e.length?new n(e[0],e[1]):new Error(e[0])}function o(t){r(_(t),"function",t)}function i(t){r(y(t),"array",t)}function s(t){r(!p(t),"Sequence is empty!")}function l(t){r(m(t),"iterable",t)}function u(t){r(d(t),"numeric value",t)}function c(t,e,n=1/0){u(t),r(t>=e&&t<=n,`Number must be between ${e} and ${n}!`)}function a(t,e){var n;r(g(n=t),"collection",n),r(d(e),"number",e),r(e>=0&&e<t.count(),"Index is out of bounds")}function f(t,e){return t===e}function h(t,e){return t<e?-1:e<t?1:0}function y(t){return t instanceof Array}function _(t){return"function"==typeof t}function d(t){return"number"==typeof t&&!isNaN(t)}function p(t){return m(t)&&t[Symbol.iterator]().next().done}function m(t){return Symbol.iterator in Object(t)}function b(t){return"string"==typeof t}function g(t){return t instanceof A}function w(t){return t instanceof function*(){}.constructor}function x(t){return void 0===t}function O(t){return!k(t)&&_(t)&&1==j(t)}e.defaultComparator=h,e._isArray=y,e._isFunction=_,e._isNumeric=d,e._isEmpty=p,e._isIterable=m,e._isString=b,e._isCollection=g,e._isGenerator=w,e._isUndefined=x,e._isPredicate=O;const v=[Object,Number,Boolean,String,Symbol];function k(t){return"function"==typeof t&&/native code/.test(Object(t).toString())||!!~v.indexOf(t)}function S(t,e,n,r){o(n),o(r);let i=e;for(let e of t)i=n(i,e);return r(i)}function E(t=Object){if(t&&k(t)&&"function"==typeof t){let e=t();return e instanceof Object||t===Date?null:e}return t}function j(t){return o(t),t.length}function D(t,e=h){if(_(t))return new Function("comparator","keySelectorFn","a","b","return comparator(keySelectorFn(a), keySelectorFn(b))").bind(null,e,t);if(b(t))return t.startsWith("[")||t.startsWith(".")||(t=`.${t}`),new Function("comparator","a","b",`return comparator(a${t}, b${t})`).bind(null,e);throw new n("string or function",t)}e._isNative=k;class A{constructor(t){this.__iterable=null,r(m(t)||w(t),"iterable or generator",t),this.__iterable=t}[Symbol.iterator](){const t=this.__iterable;return w(t)?t():function*(){yield*t}()}__resultOrDefault(t,e=(t=>!0),n=Object){let r;O(e)?r=e:(r=(t=>!0),n=e),o(r);const i=E(n);if(p(this))return i;let s=t.call(this,r);return s||i}elementAt(t){return a(this,t),this.skip(t).first()}take(t=0){if(u(t),t<=0)return A.empty;const e=this;return new A(function*(){let n=0;for(let r of e)if(yield r,++n===t)break})}skip(t=0){return u(t),t<=0?this:this.skipWhile((e,n)=>n<t)}takeWhile(t=((t,e)=>!0)){o(t);const e=this;return new A(function*(){let n=0;for(let r of e){if(!t(r,n++))break;yield r}})}takeUntil(t=((t,e)=>!1)){return this.takeWhile((e,n)=>!t(e,n))}skipWhile(t=((t,e)=>!0)){o(t);const e=this;return new A(function*(){let n=0,r=!1;for(let o of e)!r&&t(o,n++)||(r=!0,yield o)})}skipUntil(t=((t,e)=>!1)){return this.skipWhile((e,n)=>!t(e,n))}first(t=(t=>!0)){return o(t),s(this),this.skipWhile(e=>!t(e))[Symbol.iterator]().next().value}firstOrDefault(t=(t=>!0),e=Object){return this.__resultOrDefault(this.first,t,e)}last(t=(t=>!0)){return o(t),s(this),this.reverse().first(t)}lastOrDefault(t=(t=>!0),e=Object){return this.__resultOrDefault(this.last,t,e)}single(t=(t=>!0)){o(t),s(this);let e;for(let n of this){if(t(n)){e=n;break}0}if(this.first(n=>t(n)&&!f(n,e)))throw new Error("Sequence contains more than one element");return e}singleOrDefault(t=(t=>!0),e=Object){return this.__resultOrDefault(this.single,t,e)}defaultIfEmpty(t){return p(this)?new A([E(t)]):this}concat(t){l(t);const e=this;return new A(function*(){yield*e,yield*t})}union(t,e=f){return l(t),this.concat(t).distinct(e)}join(t,e,n,r,i=f){l(t),o(e),o(n),o(r),o(i);const s=this;return new A(function*(){for(let o of s){const s=e(o);for(let e of t){const t=n(e);i(s,t)&&(yield r(o,e))}}})}except(t){l(t),g(t)||(t=new A(t));const e=this;return new A(function*(){for(let n of e)t.contains(n)||(yield n)})}zip(t,e){l(t),o(e);const n=this;return new A(function*(){const r=t[Symbol.iterator]();for(let t of n){const n=r.next();if(n.done)break;yield e(t,n.value)}})}intersect(t,e=f){l(t),o(e);const n=this;return new A(function*(){const r=A.from(t);for(let t of n)r.any(n=>e(t,n))&&(yield t)})}sequenceEqual(t,e=f){if(!m(t))return!1;const n=this[Symbol.iterator](),r=t[Symbol.iterator]();let o,i;do{if(o=n.next(),i=r.next(),o.done!=i.done)return!1;if(!o.done&&!e(o.value,i.value))return!1}while(!o.done);return!0}static __getEqualKey(t,e,n){for(let r of t.keys())if(n(r,e))return r;return e}groupBy(t,...e){const n=this;function i(e){let r=2===j(e);const o=n.first();try{const n=t(o);r=r&&e(n,n)&&!e(n,{})}catch(t){r=!1}return r}function s(t,e,n){let r,o,s;return i(n)?r=n:s=n,2===j(e)?s=e:o=e,r||(r=f),o||(o=(t=>t)),l(t,o,s,r)}function l(t,e,i,s){o(t),o(e),r(x(i)||_(i),"resultSelector must be undefined or function!"),o(s);let l,u=new Map;for(let r of n){const n=A.__getEqualKey(u,t(r),s),o=e(r);u.has(n)?u.get(n).push(o):u.set(n,[o])}return l=i?A.from(u).select(t=>i(...t)):u}let u;switch(e.length){case 0:u=function(t){return l(t,t=>t,void 0,f)};break;case 1:u=function(t,e){let n,r;return i(e)?(n=e,r=(t=>t)):(n=f,r=e),s(t,r,n)};break;case 2:u=s;break;case 3:u=l;break;default:throw new Error("GroupBy parameter count can not be greater than 4!")}return u(t,...e)}groupJoin(t,e,n,r,i=f){l(t),o(e),o(n),o(r);let s=new Map;const u=this;for(let r of u){const o=e(r);s.set(r,new A(function*(){for(let e of t)i(o,n(e))&&(yield e)}))}return new A(function*(){for(let[t,e]of s)yield r(t,e)})}add(t){this.insert(t,this.count())}insert(t,e){const n=this.toArray();r(e>=0&&e<=n.length,"Index is out of bounds!"),this.__iterable=function*(){yield*n.slice(0,e),yield t,yield*n.slice(e,n.length)}}remove(t){let e=this.toArray();return!!function(t,e){i(t);let n,r,o=[];for(;(r=t.shift())&&!(n=f(r,e));)o.push(r);return t.unshift(...o),n}(e,t)&&(this.__iterable=function*(){yield*e},!0)}min(t=(t=>t)){return o(t),s(this),this.select(t).aggregate((t,e)=>t<e?t:e)}max(t=(t=>t)){return o(t),s(this),this.select(t).aggregate((t,e)=>t>e?t:e)}sum(t=(t=>t)){return s(this),this.select(t).aggregate(0,(t,e)=>t+e)}average(t=(t=>t)){return s(this),this.sum(t)/this.count()}order(t=h){return this.orderBy(t=>t,t)}orderDescending(t=h){return this.orderByDescending(t=>t,t)}orderBy(t,e=h){return o(e),new M(this,D(t,e))}orderByDescending(t,e=h){return new M(this,D(t,(t,n)=>e(n,t)))}shuffle(){return this.orderBy(()=>Math.floor(3*Math.random())-1)}indexOf(t,e=f){o(e);let n=0;for(let r of this){if(e(r,t))return n;n++}return-1}lastIndexOf(t,e=f){o(e);let n=0,r=-1;for(let o of this)e(o,t)&&(r=n),n++;return r}contains(t,e=f){return!!~this.indexOf(t,e)}where(t=((t,e)=>!0)){o(t);const e=this;return new A(function*(){let n=0;for(let r of e)t(r,n)&&(yield r),n++})}conditionalWhere(t,e){return t?this.where(e):this}count(t=(t=>!0)){let e=0,n=this.where(t)[Symbol.iterator]();for(;!n.next().done;)e++;return e}any(t=null){return!p(this)&&(!t||!this.where(t)[Symbol.iterator]().next().done)}all(t=(t=>!0)){return o(t),!this.any(e=>!t(e))}aggregate(t,e=null,n=null){return!_(t)||e||n?_(t)||!_(e)||n?S(this,t,e,n):S(this,t,e,t=>t):S(this.skip(1),this.first(),t,t=>t)}select(t=(t=>t)){const e=this;let n=0;return new A(function*(){for(let r of e)yield t(r,n),n++})}flatten(){return this.selectMany(t=>t)}selectMany(t,e=((t,e)=>e)){o(t),o(e);const n=this;return new A(function*(){let r=0;for(let o of n){let n=t(o,r),i=n;i=m(n)?n:[n];for(let t of i[Symbol.iterator]())yield e(o,t);r++}})}distinct(t=f){return o(t),function(t,e=f){l(t),o(e);const n=[];return new A(function*(){t:for(let r of t){for(let t of n)if(e(r,t))continue t;n.push(r),yield r}})}(this,t)}toArray(){return[...this]}toDictionary(t,e=null,n=null){if(o(t),!e&&!n)return this.toDictionary(t,t=>t,f);if(!n&&1===j(e))return this.toDictionary(t,e,f);if(!n&&2===j(e))return this.toDictionary(t,t=>t,e);o(n),o(e);let i=[],s=new Map;for(let o of this){let l=t(o),u=e(o);r(null!=l,"Key is not allowed to be null!"),r(!A.from(i).any(t=>n(t,l)),`Key '${l}' is already in use!`),i.push(l),s.set(l,u)}return s}toLookup(t,e=null,n=null){return o(t),e||n?(n||1!==j(e))&&(n||2!==j(e))?(o(n),o(e),this.groupBy(t,e,n)):this.groupBy(t,e):this.groupBy(t)}reverse(){const t=this.toArray();return new A(function*(){for(let e=t.length-1;e>=0;e--)yield t[e]})}forEach(t){o(t);for(let e of this)t(e)}static from(t){return new A(t)}static range(t,e){return c(e,0,1/0),new A(function*(){let n=t;for(;n!=e+t;)yield n++})}static repeat(t,e){return c(e,0,1/0),new A(function*(){for(let n=0;n<e;n++)yield t})}static get empty(){return new A([])}}class B{constructor(t,e){this.__index=t,this.__value=e}static __createHeapElement(t,e){return void 0===e||e instanceof B?e:new B(t,e)}}class C{constructor(t,e=h){i(t),o(e),this.__elements=t,this.__comparator=((t,n)=>{let r=e(t.__value,n.__value);return 0!==r?r:h(t.__index,n.__index)}),this.__createHeap(this.__elements,this.__comparator)}__heapify(t,e,n){let r=2*(n+1),o=r-1,i=n;if(t[i]=B.__createHeapElement(i,t[i]),o<t.length&&(t[o]=B.__createHeapElement(o,t[o]),e(t[o],t[i])<0&&(i=o)),r<t.length&&(t[r]=B.__createHeapElement(r,t[r]),e(t[r],t[i])<0&&(i=r)),i!==n){let r=t[n];t[n]=t[i],t[i]=r,this.__heapify(t,e,i)}}__createHeap(t,e){if(0!==t.length)for(let n=Math.floor(t.length/2);n>=0;n--)this.__heapify(t,e,n)}__hasTopElement(){return this.__elements.length>0}__getTopElement(){if(1===this.__elements.length)return this.__elements.pop().__value;let t=this.__elements[0];return this.__elements[0]=this.__elements.pop(),this.__heapify(this.__elements,this.__comparator,0),t.__value}[Symbol.iterator](){let t=this;return{next:function(){return t.__hasTopElement()?{done:!1,value:t.__getTopElement()}:{done:!0,value:void 0}}}}}e._MinHeap=C;class M extends A{constructor(t,e){o(e),super(t),this.__comparator=e}thenBy(t,e=h){const n=this.__comparator,r=D(t,e);return new M(this.__iterable,(t,e)=>{const o=n(t,e);return 0!==o?o:r(t,e)})}thenByDescending(t,e=h){return this.thenBy(t,(t,n)=>e(n,t))}[Symbol.iterator](){let t=this,e=super[Symbol.iterator].bind(this);return function*(){yield*new C([...{[Symbol.iterator]:e}],t.__comparator)}()}}function I(t,n=[]){n.push("constructor");let r=e.Collection.from(n),o=[];for(let n of Object.getOwnPropertyNames(Object.getPrototypeOf(e.Collection.empty)))if(!n.startsWith("_")&&!r.contains(n)&&_(e.Collection.empty[n])){if(n in t)throw new Error(`The method "${n}" already exists on the "${t.constructor&&t.constructor.name}" prototype. `+"Use the exclude parameter to patch without this method.");o.push(n)}for(let n of o)t[n]=function(...t){let r=e.Collection.from(this);return r[n].call(r,...t)}}e.Collection=A,e.default=e.Collection,e.extendIterablePrototype=I,e.extendNativeTypes=function(){I(Array.prototype,["concat","forEach","indexOf","join","lastIndexOf","reverse"]);const t=Array.prototype.join;Array.prototype.join=function(...n){if(4==n.length||5==n.length){let t=e.Collection.from(this);return t.join.call(t,...n)}return t.call(this,...n)};const n=Array.prototype.indexOf;Array.prototype.indexOf=function(...t){if(2==t.length&&_(t[1])){let n=e.Collection.from(this);return n.indexOf.call(n,...t)}return n.call(this,...t)};const r=Array.prototype.lastIndexOf;Array.prototype.lastIndexOf=function(...t){if(2==t.length&&_(t[1])){let n=e.Collection.from(this);return n.lastIndexOf.call(n,...t)}return r.call(this,...t)},I(Map.prototype,["add","forEach"]),I(Set.prototype,["add","forEach"])}});