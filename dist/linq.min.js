/*!
 * linqjs v0.0.0
 * (c) Sven Schmidt 
 * License: MIT (http://www.opensource.org/licenses/mit-license.php)
 */
"use strict";function _toConsumableArray(a){if(Array.isArray(a)){for(var b=0,c=Array(a.length);b<a.length;b++)c[b]=a[b];return c}return Array.from(a)}!function(){var window=this||(0,eval)("this");!function(a){try{"function"==typeof define&&define.amd?define(["require","exports"],a):exports&&module&&module.exports&&a(exports||module.exports)}catch(b){a(window.linqjs={})}}(function(linqjs){function __assert(a,b){if(!a)throw new Error(b)}function __assertFunction(a){__assert(isFunction(a),"Parameter must be function!")}function __assertArray(a){__assert(isArray(a),"Parameter must be array!")}function __assertNotEmpty(a){__assert(isArray(a)),__assert(!isEmpty(a),"Sequence is empty")}function __assertIterable(a){__assert(isIterable(a),"Parameter must be iterable!")}function __assertIterationNotStarted(a){var b="StartedIterating"in a&&a.StartedIterating();__assert(!b,"Iteration already started!")}function __assertString(a){__assert(isString(a),"Parameter must be string!")}function isArray(a){return"[object Array]"===Object.prototype.toString.call(a)}function isFunction(a){return"function"==typeof a}function isNumeric(a){return!isNaN(parseFloat(a))}function isEmpty(a){return __assertArray(a),0===a.length}function isIterable(a){return Symbol.iterator in a}function isString(a){return"string"==typeof a}function __assign(a,b){if(a=Object(a),Object.hasOwnProperty("assign")&&"function"==typeof Object.assign)Object.assign(a,b);else for(var c in b)Object.prototype.hasOwnProperty.call(b,c)&&(a[c]=b[c]);return a}function __export(a){__assign(linqjs,a)}function isES6(){return new Function("\n      try {\n        return (() => true)();\n      } catch (err) {\n        return false\n      }\n    ")()}function capitalize(a){return a=String(a),a.charAt(0).toUpperCase()+a.substr(1)}function filterArray(a){var b=arguments.length<=1||void 0===arguments[1]?function(a,b){return!0}:arguments[1],c=arguments.length<=2||void 0===arguments[2]?1/0:arguments[2];__assert(isArray(a),"arr must be array!"),__assertFunction(b),__assert(isNumeric(c),"stopAfter must be numeric!");for(var d=[],e=a.length,f=0;f<e&&!(b(a[f],f)&&(d.push(a[f]),d.length>=c));f++);return d}function aggregateArray(a,b,c,d){return __assertFunction(c),__assertFunction(d),__assertNotEmpty(a),d([b].concat(a).reduce(c))}function removeDuplicates(a){var b=arguments.length<=1||void 0===arguments[1]?defaultEqualityCompareFn:arguments[1];__assert(isArray(a),"arr must be array!"),__assertFunction(b);var c=[],d=a.length;a:for(var e=0;e<d;e++){for(var f=a[e],g=0;g<c.length;g++)if(b(f,c[g]))continue a;c.push(f)}return c}function isNative(a){return/native code/.test(Object(a).toString())||!!~nativeConstructors.indexOf(a)}function getDefault(){var a=arguments.length<=0||void 0===arguments[0]?Object:arguments[0];if(a&&isNative(a)&&"function"==typeof a){var b=a();return b instanceof Object||constructor===Date?null:b}return a}function install(){__assign(Array.prototype,linqjs)}function __assertAllNumeric(a){}function Min(){var a=arguments.length<=0||void 0===arguments[0]?function(a){return a}:arguments[0];return __assertFunction(a),__assertNotEmpty(this),Math.min.apply(null,this.map(a))}function Max(){var a=arguments.length<=0||void 0===arguments[0]?function(a){return a}:arguments[0];return __assertFunction(a),__assertNotEmpty(this),Math.max.apply(null,this.map(a))}function Sum(){return __assertNotEmpty(this),this.reduce(function(a,b){return a+b})}function Average(){return __assertNotEmpty(this),Sum.call(this)/this.length}function Concat(a){return __assert(isArray(a),"second must be an array!"),Array.prototype.concat.apply(this,a)}function Union(a){var b=arguments.length<=1||void 0===arguments[1]?function(a,b){return a===b}:arguments[1];return removeDuplicates(this.Concat(a),b)}function Where(){var a=arguments.length<=0||void 0===arguments[0]?function(a,b){return!0}:arguments[0];return __assertFunction(a),filterArray(this,a)}function Count(){var a=arguments.length<=0||void 0===arguments[0]?function(a){return!0}:arguments[0];return __assertFunction(a),filterArray(this,a).length}function Any(a){return a?(__assertFunction(a),filterArray(this,a,1).length>0):this.length>0}function All(){var a=arguments.length<=0||void 0===arguments[0]?function(a){return!0}:arguments[0];return __assertFunction(a),!this.Any(function(b){return!a(b)})}function Contains(a){return!!~this.indexOf(a)}function ElementAt(a){return __assert(a<this.length&&a>=0,"Array index is out of bounds!"),__assert(isNumeric(a),"Index must be numeric!"),this[a]}function Take(){var a=arguments.length<=0||void 0===arguments[0]?0:arguments[0];return __assert(isNumeric(a),"First parameter must be numeric!"),a<=0?[]:this.slice(0,a)}function findFirstNonMatchingIndex(a,b){__assertArray(a);for(var c=a.length,d=0;d<c;d++)if(!b(a[d],d))return d;return a.length-1}function Skip(){var a=arguments.length<=0||void 0===arguments[0]?0:arguments[0];return __assert(isNumeric(a),"First parameter must be numeric!"),a<=0?this:this.slice(a,this.length)}function TakeWhile(){var a=arguments.length<=0||void 0===arguments[0]?function(a,b){return!0}:arguments[0];return __assertFunction(a),this.Take(findFirstNonMatchingIndex(this,a))}function SkipWhile(){var a=arguments.length<=0||void 0===arguments[0]?function(a,b){return!0}:arguments[0];return __assertFunction(a),this.Skip(findFirstNonMatchingIndex(this,a))}function First(){var a=arguments.length<=0||void 0===arguments[0]?function(a){return!0}:arguments[0];__assertFunction(a),__assertNotEmpty(this);var b=filterArray(this,a,1);return b[0]?b[0]:null}function resultOrDefault(a,b){var c=arguments.length<=2||void 0===arguments[2]?function(a){return!0}:arguments[2],d=arguments.length<=3||void 0===arguments[3]?Object:arguments[3];__assertArray(a);var e=void 0;if(isNative(c)?(e=function(a){return!0},d=c):e=c,__assertFunction(e),__assert(isNative(d),"constructor must be native constructor, e.g. Number!"),!isEmpty(a)){var f=b.call(a,e);if(f)return f}return getDefault(d)}function FirstOrDefault(){var a=arguments.length<=0||void 0===arguments[0]?function(a){return!0}:arguments[0],b=arguments.length<=1||void 0===arguments[1]?Object:arguments[1];return resultOrDefault(this,First,a,b)}function Last(){var a=arguments.length<=0||void 0===arguments[0]?function(a){return!0}:arguments[0];return __assertFunction(a),__assertNotEmpty(this),this.reverse().First(a)}function LastOrDefault(){var a=arguments.length<=0||void 0===arguments[0]?function(a){return!0}:arguments[0],b=arguments.length<=1||void 0===arguments[1]?Object:arguments[1];return resultOrDefault(this,Last,a,b)}function Single(){var a=arguments.length<=0||void 0===arguments[0]?function(a){return!0}:arguments[0];__assertFunction(a),__assertNotEmpty(this);var b=filterArray(this,a);if(1===b.length)return b[0];throw new Error("Sequence contains more than one element")}function SingleOrDefault(){var a=arguments.length<=0||void 0===arguments[0]?function(a){return!0}:arguments[0],b=arguments.length<=1||void 0===arguments[1]?Object:arguments[1];return resultOrDefault(this,Single,a,b)}function DefaultIfEmpty(a){return isEmpty(this)?[getDefault(a)]:this}function Order(){return this.OrderBy(defaultComparator)}function OrderCompare(){return this.sort(defaultComparator)}function OrderBy(a){__assertFunction(a);var b=new MinHeap(this,a);return getArrayFromIterable(b)}function OrderDescending(){return this.OrderByDescending(defaultComparator)}function OrderByDescending(a){__assertFunction(a);var b=new MaxHeap(this,a);return getArrayFromIterable(b)}function Aggregate(a,b,c){return"function"!=typeof a||b||c?"function"==typeof a||"function"!=typeof b||c?aggregateArray(this,a,b,c):aggregateArray(this,a,b,function(a){return a}):aggregateArray(this.slice(1,this.length),this[0],a,function(a){return a})}function Distinct(){var a=arguments.length<=0||void 0===arguments[0]?defaultEqualityCompareFn:arguments[0];return __assertFunction(a),removeDuplicates(this,a)}function Linq(a){return __assertIterable(a),new LinqCollection(a)}function GetComparatorFromKeySelector(selector){if(__assertString(selector),""===selector)return Array.prototype.DefaultComparator;selector.startsWith("[")||selector.startsWith(".")||(selector="."+selector);var result=void 0;return eval("result = function (a, b) { return Array.prototype.DefaultComparator(a"+selector+", b"+selector+") }"),result}var defaultEqualityCompareFn=function(a,b){return a===b},nativeConstructors=[Object,Number,Boolean,String,Symbol],DefaultComparator=function(a,b){return a<b?-1:b<a?1:0},MinHeap=function(){function a(a){var b=arguments.length<=1||void 0===arguments[1]?DefaultComparator:arguments[1];__assertArray(a),__assertFunction(b),this.comparator=b,this.elements=a,c(this.elements,this.comparator)}function b(a,c,d){var e=2*(d+1),f=e-1,g=d;if(f<a.length&&c(a[f],a[g])<0&&(g=f),e<a.length&&c(a[e],a[g])<0&&(g=e),g!==d){var h=a[d];a[d]=a[g],a[g]=h,b(a,c,g)}}function c(a,c){for(var d=Math.floor(a.length/2);d>=0;d--)b(a,c,d)}return a.prototype.hasTopElement=function(){return this.elements.length>0},a.prototype.getTopElement=function(){if(1===this.elements.length)return this.elements.pop();var a=this.elements[0],c=this.elements.pop();return this.elements[0]=c,b(this.elements,this.comparator,0),a},a.prototype[Symbol.iterator]=function(){var a=this;return{next:function(){return a.hasTopElement()?{done:!1,value:a.getTopElement()}:{done:!0}}}},a}(),MaxHeap=function(){function a(a){var b=arguments.length<=1||void 0===arguments[1]?DefaultComparator:arguments[1];__assertArray(a),__assertFunction(b),MinHeap.apply(this,[a,function(a,c){return-1*b(a,c)}])}return a.prototype=Object.create(MinHeap.prototype),a.prototype.constructor=a,a}(),LinqCollection=function(){function a(a){__assertIterable(a),this._source=a,this.__startedIterating=!1,this.__iterationIndex=0}return a.prototype._initialize=function(){this.__sourceIterator=this._source[Symbol.iterator]()},a.prototype._next=function(){return this.__sourceIterator.next()},a.prototype.__wrappedNext=function(){this.__startedIterating||(this.__startedIterating=!0,this._initialize());var a=this._next();return a.done||(a.index=this.__iterationIndex,this.__iterationIndex++),a},a.prototype.ToArray=function(){return[].concat(_toConsumableArray(this))},a.prototype.StartedIterating=function(){return this.__startedIterating},a.prototype[Symbol.iterator]=function(){var a=this;return __assertIterationNotStarted(this),{next:function(){return a.__wrappedNext()}}},a}(),OrderedLinqCollection=function(){function a(a,b,c){__assertIterable(a),__assertFunction(b),__assertFunction(c),LinqCollection.apply(this,[a]),this.__comparator=b,this.__heapConstructor=c}return a.prototype=Object.create(LinqCollection.prototype),a.prototype.constructor=a,a.prototype.ThenBy=function(a){__assertIterationNotStarted(this),isString(a)&&(a=GetComparatorFromKeySelector(a)),__assertFunction(a);var b=this.__comparator;return this.__comparator=function(c,d){var e=b(c,d);return 0!==e?e:a(c,d)},this},a.prototype._initialize=function(){var a=[].concat(_toConsumableArray(this._source)),b=Reflect.construct(this.__heapConstructor,[a,this.__comparator]);this.__heapIterator=b[Symbol.iterator]()},a.prototype._next=function(){return __assert(!!this.__heapIterator,"No heap build!"),this.__heapIterator.next()},a}();!function(){LinqCollection.prototype.OrderBy=function(a){return isString(a)&&(a=GetComparatorFromKeySelector(a)),__assertFunction(a),new OrderedLinqCollection(this,a,MinHeap)},LinqCollection.prototype.OrderByDescending=function(a){return isString(a)&&(a=GetComparatorFromKeySelector(a)),__assertFunction(a),new OrderedLinqCollection(this,a,MaxHeap)}}(),__export({install:install,Min:Min,Max:Max,Average:Average,Sum:Sum,Concat:Concat,Union:Union,Where:Where,Count:Count,Any:Any,All:All,ElementAt:ElementAt,Take:Take,TakeWhile:TakeWhile,Skip:Skip,SkipWhile:SkipWhile,Contains:Contains,First:First,FirstOrDefault:FirstOrDefault,Last:Last,LastOrDefault:LastOrDefault,Single:Single,SingleOrDefault:SingleOrDefault,DefaultIfEmpty:DefaultIfEmpty,DefaultComparator:DefaultComparator,MinHeap:MinHeap,MaxHeap:MaxHeap,Order:Order,OrderCompare:OrderCompare,OrderBy:OrderBy,OrderDescending:OrderDescending,OrderByDescending:OrderByDescending,Aggregate:Aggregate,Distinct:Distinct,LinqCollection:LinqCollection,Linq:Linq,GetComparatorFromKeySelector:GetComparatorFromKeySelector,OrderedLinqCollection:OrderedLinqCollection})})}();